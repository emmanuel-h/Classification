<?php

namespace LIFO\ClassifBundle\Repository;

use Doctrine\ORM\EntityRepository;

/**
 * TessonRepository
 *
 * This class was generated by the Doctrine ORM. Add your own custom
 * repository methods below.
 */
class TessonRepository extends \Doctrine\ORM\EntityRepository {
	public function findNumIsolationMax($us_id, $site_id) {
		$qb = $this->_em->createQueryBuilder('t')
		->select('MAX(t.numIsolation)')
		->from('LIFOClassifBundle:Tesson', 't')
		->leftJoin('t.us', 'u')
		->leftJoin('t.site', 's')
		->where('u.id=:us_id')
		->andWhere('s.id=:site_id')
		->setParameter('us_id', $us_id)
		->setParameter('site_id', $site_id);
		return $qb->getQuery()->getSingleScalarResult ();
	}
}
